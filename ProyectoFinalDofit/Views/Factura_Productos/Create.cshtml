
@model ProyectoFinalDofit.Models.Factura_Productos

@{
    ViewBag.Title = "Create";
}

<h2>Create</h2>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<!-- Formulario para agregar productos al carrito -->
<div class="form-horizontal">
    <h4>Agregar producto al carrito</h4>
    <hr />
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
    <div class="form-group">
        @Html.LabelFor(model => model.Cantidad, htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.Cantidad, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Cantidad, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Costo_Unitario, htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.Costo_Unitario, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.Costo_Unitario, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Factura_Id, "Factura_Id", htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.DropDownList("Factura_Id", null, htmlAttributes: new { @class = "form-control" })
            @Html.ValidationMessageFor(model => model.Factura_Id, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Articulo_Id, "Articulo_Id", htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.DropDownList("Articulo_Id", null, htmlAttributes: new { @class = "form-control" })

            @Html.ValidationMessageFor(model => model.Articulo_Id, "", new { @class = "text-danger" })
        </div>
    </div>


    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input type="button" value="Agregar al carrito" class="btn btn-default" onclick="addToCart()" />
        </div>
    </div>
</div>

<!-- Tabla para mostrar los productos en el carrito -->
<table id="cart">
    <tr>
        <th>Producto</th>
        <th>Cantidad</th>
    </tr>
    <!-- Los productos se agregarán aquí -->
</table>

@using (Html.BeginForm("Create", "Factura_Productos", FormMethod.Post))
{
    
    <input type="submit" value="Crear" class="btn btn-default" onclick="return confirm('¿Estás seguro de que quieres finalizar la venta?');" />

}


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}

<script>
    function addToCart() {
        var articuloId = $('#Articulo_Id').val();
        var cantidad = $('#Cantidad').val();
        $.ajax({
            url: '/Factura_Productos/AddToCart',
            type: 'POST',
            data: { Articulo_Id: articuloId, Cantidad: cantidad },
            success: function (response) {
                // Agrega el producto al carrito en la vista
                $('#cart').append('<tr><td>' + articuloId + '</td><td>' + cantidad + '</td></tr>');
            }
        });
    }
</script>
